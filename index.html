<!DOCTYPE html>
<html lang="en">
<meta charset="utf-8">

<link href="css/nv.d3.css" rel="stylesheet" type="text/css">
<link href="css/bootstrap.css" rel="stylesheet" media="screen">
<link href="css/sequences.css" rel="stylesheet" media="screen">
<style>

body {
	overflow: hidden;
}

text {
  font: 12px sans-serif;
}

.nvd3 .nv-groups .nv-point .nv-line{
    stroke-opacity: 0.3 !important;
    stroke-width: 10px;
}

#chart1 {
  min-width: 100px;
  min-height: 100px;
/*
  Minimum height and width is a good idea to prevent negative SVG dimensions...
  For example width should be =< margin.left + margin.right + 1,
  of course 1 pixel for the entire chart would not be very useful, BUT should not have errors
*/
}

#chart1 svg {
  height: 300px;
}

#chart2 svg {
  height: 500px;
}

#chart2 {
  min-width: 100px;
  min-height: 100px;
/*
  Minimum height and width is a good idea to prevent negative SVG dimensions...
  For example width should be =< margin.left + margin.right + 1,
  of course 1 pixel for the entire chart would not be very useful, BUT should not have errors
*/
}

#chartExPerCapital svg {
  width: 1300px;
  height: 500px;
  margin: 10px;
  min-width: 100px;
  min-height: 100px;
/*
  Minimum height and width is a good idea to prevent negative SVG dimensions...
  For example width should be =< margin.left + margin.right + 1,
  of course 1 pixel for the entire chart would not be very useful, BUT should not have errors
*/

</style>
<head>
	<title>Team DataWiz: Number of visitors of Singapore</title>
</head>
<body>	
	<div class="container-fluid carousel">
			
		<div id="myCarousel" class="carousel slide">
			<ol class="carousel-indicators">
				<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
				<li data-target="#myCarousel" data-slide-to="1"></li>
			</ol>
			<!-- Carousel items -->
			<div class="carousel-inner">
				<div class="active item">
				<div class="row">
				<div class="span14 offset1">
					<h3>Total number of visitors 2009 - 2013</h3>
				</div>	
						<div class="span14 offset1"><h4>Please select the country:</h4>				
								<img src="img/australia.png" style="width: 50px;height:25px;" id="Australia" alt="Australia" class="img-polaroid flag">
								<img src="img/china.png" style="width: 50px;height:25px;" id="China" alt="China" class="img-polaroid flag">
								<img src="img/india.jpg" style="width: 50px;height:25px;" id="India" alt="India" class="img-polaroid flag">
								<img src="img/indonesia.png" style="width: 50px;height:25px;" id="Indonesia" alt="Indonesia" class="img-polaroid flag">
								<img src="img/japan.png" style="width: 50px;height:25px;" id="Japan" alt="Japan" class="img-polaroid flag">
								<img src="img/malaysia.png" style="width: 50px;height:25px;" id="Malaysia" alt="Malaysia" class="img-polaroid flag">
								<img src="img/philippines.png" style="width: 50px;height:25px;" id="Philippines" alt="Philippines" class="img-polaroid flag">
								<img src="img/thailand.png" style="width: 50px;height:25px;" id="Thailand" alt="Thailand" class="img-polaroid flag">
								<img src="img/UK.png" style="width: 50px;height:25px;" id="UK" alt="UK" class="img-polaroid flag">
								<img src="img/USA.png" style="width: 50px;height:25px;" id="USA" alt="USA" class="img-polaroid flag">	
						</div>
					</div>
					 <!--<div class="offset1">The diagram shows the total number of visitors over the year</div> -->				
					<div class="row">
						<div class="span8">
							<div class="row">
								<div class="span5 offset1">
									<h4>Number of Singapore visitors over 5 years (2009-2013), top 10</h4>
								</div>
								<div class="span8">
								  <div id="chart1" class='with-3d-shadow with-transitions' style="margin-top:-5px;">
									<svg></svg>
								  </div>
								</div>
						  </div>
						</div>
						<div class="span8">
						<div class="row">
							<!--<h4>&nbsp;&nbsp;&nbsp;&nbsp;Expenditure in Singapore over 5 years</h4>	-->
							<div class="span5 offset1">
									<h4>Expenditure per capita of Singapore visitors over 5 years (2009-2013), top 10</h4>
								</div>
							<div class="span8">
								<div id="expenditureLineChart" >
									<svg style="height: 300px;"></svg>
								</div>
							</div>
						</div>
					</div>
					</div>				
					<div class="row" style="margin-top:-10px;">
						<div class="offset1">
							<div id="pieDescOverview">
								<h3>10 countries visitor mode of transport to Singapore over 5 years (2009 - 2013)</h3>
							</div>						
						</div>
					
							<div style="float:right;margin-right:50px;margin-top:-45px;" class="btn btn-link" id="revertBtn"><u>click here to revert</u></div>
						
						<div class="span14 offset1">
						<!--	<div id="pieDesc" style="visibility:hidden"><h3 id="transportationMode"><span id="countryName"></span> visitor mode of transport over 5 years (2009 - 2013)</h3></div> -->
							<div class="row">
								<div class="span2">
									<svg id="transportationModePie1" class="mypiechart" style="height: 150px; width: 200px;"></svg>	
									<p align="center" style="margin-top:-20px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2009</p>
								</div>
								<div class="span2 offset1">
									<svg id="transportationModePie2" class="mypiechart" style="height: 150px; width: 200px;"></svg>
									<p align="center" style="margin-top:-20px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2010</p>
								</div>
								<div class="span2 offset1">
									<svg id="transportationModePie3" class="mypiechart" style="height: 150px; width: 200px;"></svg>
									<p align="center" style="margin-top:-20px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2011</p>
								</div>
								<div class="span2 offset1">
									<svg id="transportationModePie4" class="mypiechart" style="height: 150px; width: 200px;"></svg>
									<p align="center" style="margin-top:-20px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2012</p>
								</div>
								<div class="span2 offset1">
									<svg id="transportationModePie5" class="mypiechart" style="height: 150px; width: 200px;"></svg>
									<p align="center" style="margin-top:-20px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2013</p>
								</div>
							</div>
							
						</div>
					</div>
				</div>
				<div class="item">
					<div class="row">
						<div class="span6 offset1">
							<h3>Expenditure per capital versus length of stay, top 10</h3>
						</div>	
						<div class="span14 offset1"><h4>Please select the country:</h4>				
								<img src="img/australia.png" style="width: 50px;height:25px;" id="Australia2" alt="Australia" class="img-polaroid flag2 Australia">
								<img src="img/china.png" style="width: 50px;height:25px;" id="China2" alt="China" class="img-polaroid flag2 China">
								<img src="img/india.jpg" style="width: 50px;height:25px;" id="India2" alt="India" class="img-polaroid flag2 India">
								<img src="img/indonesia.png" style="width: 50px;height:25px;" id="Indonesia2" alt="Indonesia" class="img-polaroid flag2 Indonesia">
								<img src="img/japan.png" style="width: 50px;height:25px;" id="Japan2" alt="Japan" class="img-polaroid flag2 Japan">
								<img src="img/malaysia.png" style="width: 50px;height:25px;" id="Malaysia2" alt="Malaysia" class="img-polaroid flag2 Malaysia">
								<img src="img/philippines.png" style="width: 50px;height:25px;" id="Philippines2" alt="Philippines" class="img-polaroid flag2 Philippines">
								<img src="img/thailand.png" style="width: 50px;height:25px;" id="Thailand2" alt="Thailand" class="img-polaroid flag2 Thailand">
								<img src="img/UK.png" style="width: 50px;height:25px;" id="UK2" alt="UK" class="img-polaroid flag2 UK">
								<img src="img/USA.png" style="width: 50px;height:25px;" id="USA2" alt="USA" class="img-polaroid flag2 USA">	
						</div>
						<div class="span14">
							<div id="chartExPerCapital" class='with-3d-shadow with-transitions'>
								<svg></svg>
							</div>
						</div>
					</div>
				</div>
			<!-- Carousel nav -->
			</div>
			<a class="carousel-control left" href="#myCarousel" data-slide="prev">&lsaquo;</a>
			<a class="carousel-control right" href="#myCarousel" data-slide="next">&rsaquo;</a>
		
	</div>
		
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
<script src="js/jquery-1.11.1.min.js"></script>
<script src="js/bootstrap-transition.js"></script>
<script src="js/bootstrap-alert.js"></script>
<script src="js/bootstrap-modal.js"></script>
<script src="js/bootstrap-dropdown.js"></script>
<script src="js/bootstrap-scrollspy.js"></script>
<script src="js/bootstrap-tab.js"></script>
<script src="js/bootstrap-tooltip.js"></script>
<script src="js/bootstrap-popover.js"></script>
<script src="js/bootstrap-button.js"></script>
<script src="js/bootstrap-collapse.js"></script>
<script src="js/bootstrap-carousel.js"></script>
<script src="js/bootstrap-typeahead.js"></script>
<script src="js/d3.v3.js"></script>
<script src="js/nv.d3.js"></script>
<script src="js/utils.js"></script>
<script src="js/tooltip.js"></script>
<script src="js/legend.js"></script>
<script src="js/axis.js"></script>
<script src="js/multiBarHorizontal.js"></script>
<script src="js/multiBarHorizontalChart.js"></script>
<script src="js/pie.js"></script>
<script src="js/pieChart.js"></script>
<script src="js/stream_layers.js"></script>
<script src="js/record.js"></script>
<script src="js/interactiveLayer.js"></script>
<script src="js/scatter.js"></script>
<script src="js/line.js"></script>
<script src="js/lineChart.js"></script>
<script src="js/historicalBar.js"></script>
<script src="js/linePlusBarWithFocusChart.js"></script>
<!--<script src="js/linePlusBarWithFocusChartApplication.js"></script>-->
<!--<script src="js/sequences.js"></script>-->
<script>


$(document).ready(function(){
	$('.carousel').carousel('pause');
});

var chart;
nv.addGraph(function() {
  chart = nv.models.lineChart()
      .margin({left: 100})
  .forceY([0,3200000])
  .options({
	showXAxis: true,
    showYAxis: true,
    transitionDuration: 250,
	//showLegend:false
  })

  chart.yAxis
	  .axisLabel("Million(SGD)")
      .tickFormat(d3.format(',.f'));
  
  chart.xAxis
    .axisLabel("Visitors");
	
  d3.select('#chart1 svg')
      .datum(noVisitor)
      .call(chart)
	  ;

  nv.utils.windowResize(chart.update);

  chart.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });
  chart.lines.dispatch.on("elementClick", function(e) { 
	console.log(e);
	//e.target.style.opacity = "10px";
  });
  //click the bar to check the value inside it
  //chart.lineChart.dispatch.on("elementClick", function(e) {
    //console.log(e.point.label);
	//console.log(e.series.key);
	//alert(window[e.point.label+e.series.key]);
	//$("#pieDescOverview").css('visibility','hidden');
	//$("#pieDesc").css('visibility','visible');
	//$("#countryYear").html(e.point.label);
	//$("#countryName").html(e.series.key);
	
   //findCountryTransportation(e.series.key+e.point.label);
   
	
	//d3.select('#expenditureLineChart svg').call(chart2);
	//$('.carousel').carousel(1);
	//$('.carousel').carousel('pause');
 // });
  
	d3.selectAll(".nv-line").on("click", function (e) {
		console.log(e);
		
	});
  
  return chart;
});



/**
$("#change").on("click",function(){
	d3.select('#chart1 svg')
      .datum(long_short_data2)
      .call(chart);
});

$("#change2").on("click",function(){
	d3.select('#chart1 svg')
      .datum(number_visitor_data)
      .call(chart);
});
**/

//pie chart generation js
var chart3;
nv.addGraph(function() {
    var width = 200,
        height = 150;

     chart3 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

      d3.select("#transportationModePie1")
          .datum(pie2009)
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart3);

    chart3.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

    return chart3;
});

var chart4;
nv.addGraph(function() {
    var width = 200,
        height = 150;

     chart4 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

      d3.select("#transportationModePie2")
          .datum(pie2010)
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart4);

    chart4.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

    return chart4;
});

var chart5;
nv.addGraph(function() {
    var width = 200,
        height = 150;

     chart5 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

      d3.select("#transportationModePie3")
          .datum(pie2011)
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart5);

    chart5.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

    return chart5;
});

var chart6;
nv.addGraph(function() {
    var width = 200,
        height = 150;

     chart6 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

      d3.select("#transportationModePie4")
          .datum(pie2012)
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart6);

    chart6.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

    return chart6;
});

var chart7;
nv.addGraph(function() {
    var width = 200,
        height = 150;

    var chart7 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

      d3.select("#transportationModePie5")
          .datum(pie2013)
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart7);

    chart7.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

    return chart7;
});


//line chart
var chart2;
nv.addGraph(function() {
  chart2 = nv.models.lineChart()
  //.useInteractiveGuideline(true)
   //.rightAlignYAxis(true)
   .margin({left: 100})
  .forceY([0,3000])
  .options({
	showXAxis: true,
    showYAxis: true,
    transitionDuration: 250,
	//showLegend: false
  })
  ;

  // chart sub-models (ie. xAxis, yAxis, etc) when accessed directly, return themselves, not the parent chart, so need to chain separately
  chart2.xAxis
    .axisLabel("Year (2009 - 2013)")
    .tickFormat(d3.format('d'));

  chart2.yAxis
    .axisLabel('Million (SGD)')
    .tickFormat(d3.format(',2f'))
    ;

  d3.select('#expenditureLineChart svg')
    .datum(expenditure)
    .call(chart2);

  //TODO: Figure out a good way to do this automatically
  nv.utils.windowResize(chart2.update);
  //nv.utils.windowResize(function() { d3.select('#expenditureLineChart svg').call(chart2) });

  chart2.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

  return chart2;
});


function findCountryTransportation(id){
	nv.addGraph(function() {
    var width = 200,
        height = 150;

    chart3 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

    d3.select("#transportationModePie1")
          .datum(window[id+'2009'])
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart3);
	
	chart4 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

    d3.select("#transportationModePie2")
          .datum(window[id+'2010'])
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart4);

	chart5 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

    d3.select("#transportationModePie3")
          .datum(window[id+'2011'])
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart5);
	
	chart6 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

    d3.select("#transportationModePie4")
          .datum(window[id+'2012'])
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart6);
	
	chart7 = nv.models.pieChart()
        .x(function(d) { return d.key })
        .y(function(d) { return d.y })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

    d3.select("#transportationModePie5")
          .datum(window[id+'2013'])
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart7);



    //chart3.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

   // return chart3;
});
}

$(".flag").click(function(){
	//alert(this.id);
	$('.flag').css('padding','4px');
	$('.flag').css('background-color','#fff');
	$('.flag').css('border','1px solid #ccc;');
	$('.flag').css('border','1px solid rgba(0, 0, 0, 0.2)');
	$('.flag').css('-webkit-box-shadow','0 1px 3px rgba(0, 0, 0, 0.1)');
	$('.flag').css('-moz-box-shadow','0 1px 3px rgba(0, 0, 0, 0.1)');
	$('.flag').css('box-shadow','0 1px 3px rgba(0, 0, 0, 0.1)');
	$('#pieDescOverview').html('<h3>'+this.id+' visitor mode of transport to Singapore over 5 years (2009-2013)</h3>');
	$('#'+this.id).css('border','1px solid black');
	$('#'+this.id).css('background-color','black');
	findCountryTransportation(this.id);

/**	$("#chartExpenditureBD").empty();
	$("#legend").empty();
	//$("#chartExpenditureBD").append("<svg></svg>");
	
	
vis = d3.select("#chartExpenditureBD").append("svg:svg")
    .attr("width", width)
    .attr("height", height)
    .append("svg:g")
    .attr("id", "container")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

	
	d3.text("csv/visit-sequences2.csv", function(text2) {
	  var csv = d3.csv.parseRows(text2);
	  var json = buildHierarchy(csv);
	  createVisualization(json);
	});
**/
});

$("#revertBtn").click(function(){
	$('.flag').css('padding','4px');
	$('.flag').css('background-color','#fff');
	$('.flag').css('border','1px solid #ccc;');
	$('.flag').css('border','1px solid rgba(0, 0, 0, 0.2)');
	$('.flag').css('-webkit-box-shadow','0 1px 3px rgba(0, 0, 0, 0.1)');
	$('.flag').css('-moz-box-shadow','0 1px 3px rgba(0, 0, 0, 0.1)');
	$('.flag').css('box-shadow','0 1px 3px rgba(0, 0, 0, 0.1)');
	$('#pieDescOverview').html('<h3>10 countries visitor mode of transport to Singapore over 5 years (2009 - 2013)</h3>');
	findCountryTransportation('pie');
});

var chart8;
nv.addGraph(function() {
     chart8 = nv.models.linePlusBarWithFocusChart()
        .margin({top: 30, right: 60, bottom: 50, left: 70})
        .x(function(d,i) { return i })
        .color(d3.scale.category10().range());

	chart8.xAxis.tickFormat(function(d) {

      var dx = Australia2[0].values[d] && Australia2[0].values[d].x || 0;
      if (dx > 0) {
			return dx
		  //return d3.time.format('%x')(new Date(dx))
      }
      return null;
    });
	
    chart8.x2Axis.tickFormat(function(d) {
      var dx = Australia2[0].values[d] && Australia2[0].values[d].x || 0;
	    if (dx > 0) {
	  return dx
      //return d3.time.format('%x')(new Date(dx))
	  }
    });
     
    chart8.y1Axis
        .tickFormat(d3.format(',f'));

    chart8.y3Axis
        .tickFormat(d3.format(',f'));
        
    chart8.y2Axis
        .tickFormat(function(d) { return d3.format(',.2f')(d) });

    chart8.y4Axis
        .tickFormat(function(d) { return d3.format(',.2f')(d) });
      
    chart8.bars.forceY([0]);
    chart8.bars2.forceY([0]);
    //chart.lines.forceY([0]);
    //nv.log(indonesia);
    d3.select('#chartExPerCapital svg')
        .datum(Australia2)
        .call(chart8);

//    nv.utils.windowResize(chart.update);

    return chart8;
});

$(".flag2").click(function(){
	//d3.select("#chartExPerCapital svg").remove();
	newMultiBar(window[this.id]);
});

function newMultiBar(country){
	nv.addGraph(function() {
     chart8 = nv.models.linePlusBarWithFocusChart()
        .margin({top: 30, right: 60, bottom: 50, left: 70})
        .x(function(d,i) { return i })
        .color(d3.scale.category10().range());

	chart8.xAxis.tickFormat(function(d) {

      var dx = country[0].values[d] && country[0].values[d].x || 0;
      if (dx > 0) {
			return dx
		  //return d3.time.format('%x')(new Date(dx))
      }
      return null;
    });
	
    chart8.x2Axis.tickFormat(function(d) {
      var dx = country[0].values[d] && country[0].values[d].x || 0;
	    if (dx > 0) {
	  return dx
      //return d3.time.format('%x')(new Date(dx))
	  }
    });
     
    chart8.y1Axis
        .tickFormat(d3.format(',f'));

    chart8.y3Axis
        .tickFormat(d3.format(',f'));
        
    chart8.y2Axis
        .tickFormat(function(d) { return d3.format(',.2f')(d) });

    chart8.y4Axis
        .tickFormat(function(d) { return d3.format(',.2f')(d) });
      
    chart8.bars.forceY([0]);
    chart8.bars2.forceY([0]);
    //chart.lines.forceY([0]);
    //nv.log(indonesia);
    d3.select('#chartExPerCapital svg')
        .datum(country)
        .call(chart8);

//    nv.utils.windowResize(chart.update);

    return chart8;
});
};



</script>
</html>